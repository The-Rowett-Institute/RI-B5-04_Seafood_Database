---
title: "UK_seafood-availability"
author: "Lofstedt, A"
date: "2022-11-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Result 1: UK net seafood availability 

Average UK net per capita seafood supplies between 2009 and 2019 were derived from data on imports and production (from both capture fisheries and aquaculture), accounting for exports. UK fish dietary recommendations were compared with national seafood supplies. 

The data set created from the RESAS B5 project was used to calculate UK seafood availability. 
Seafood production (aquaculture, capture), trade (imports and exports), consumption and purchasing data were collated from separate data sources. Appropriate conversion factors were previously applied (live weight to processed weight) and converted from tonnes to grams/capita/ day.

### Preparation 

```{r Load libraries, include=FALSE}
# Load packages
library(tidyr) # for tidying data
library(dplyr) # base R alternative but neater
library(vroom) # for loading and transforming data
library(tidyverse) # data exploration 
library(reshape2) # for melting data frames i.e. short and wide to long and thin
library(data.table) # for fread()-function
library(mice) # md.pattern to show missing data
library(plyr) # joins multiple data frames together

```

```{r Load file path, echo=TRUE}
# Loading file path to the data into a value 
source("Data_filepath.R")# Data_filepath.R is listed in .gitignore-file. So, you will need to create that file yourself and provide your respected filepath using "data_dir <- [enter your here]"
```

```{r Specify the desired file path}
filepath <- paste(data_dir,"ProcessedData", sep="") 
# note we are able to change this to another file e.g. saving the output

```

# Load in cleaned data

```{r Load UK capture production data}
# Read in UK capture production data 
df_captProd_NS_data <- vroom(file=paste(filepath,"ProductionData_NS_clean.csv", sep="/"))

# Check for missing data
# right column summed to be total number of rows in the data set
md.pattern(df_captProd_NS_data, rotate.names = TRUE)
```


```{r Load UK aqauculture production data}
# Read in UK aquaculture data 
df_aquaProd_Eurostat_data <- vroom(file=paste(filepath,"FarmedData_Eurostat_clean.csv", sep="/"), na = c("NA"))

# Check for missing data
md.pattern(df_aquaProd_Eurostat_data, rotate.names = TRUE)

# Some rows with no data- omit rows with NA from the data set so omit rows with NA 
df_aquaProd_Eurostat_data_omit <- na.omit(df_aquaProd_Eurostat_data)
md.pattern(df_aquaProd_Eurostat_data_omit, rotate.names = TRUE)

# Rename species column in aquaculture data set 
#df_aquaProd_Eurostat_data_omit <- rename(df_aquaProd_Eurostat_data_omit, Species = #SimplifiedSpecies)
#colnames(df_aquaProd_Eurostat_data_omit) <- c("...1", "SACN","SpeciesType", #"Species","Year","ValueGramsCapitaWeek", "DataSource","DataSet","Commodity", "Flag")


# Read in UK trade data (further cleaned)
df_trade_HMRC_data <- vroom(file=paste(filepath,"Trade_HMRC_clean.csv", sep="/"))
md.pattern(df_trade_HMRC_data, rotate.names =  TRUE)

# Read in UK household purchasing data 
df_housePurch_DEFRA_data <- vroom(file=paste(filepath,"HouseholdPurchases_DEFRA_clean.csv", sep="/"))
md.pattern(df_housePurch_DEFRA_data, rotate.names = TRUE)

# Read in UK eating out purchasing data 
df_eatenOutPurch_DEFRA_data <- vroom(file=paste(filepath,"EatenOutPurchases_DEFRA_clean.csv", sep="/"))
md.pattern(df_eatenOutPurch_DEFRA_data, rotate.names = TRUE)

```


```{r Merge data sets}
# Merge production, trade, purchasing and consumption data 
UK_seafood_data <- rbind(df_captProd_NS_data, df_aquaProd_Eurostat_data_omit,
                         df_housePurch_DEFRA_data, df_eatenOutPurch_DEFRA_data,
                         df_trade_HMRC_data)

# Check structure of data set
str(UK_seafood_data)

# Check for missing values
md.pattern(UK_seafood_data, rotate.names = T)

# Merge production and trade data
UK_seafood_data <- rbind(df_captProd_NS_data, df_aquaProd_Eurostat_data,
                         df_trade_HMRC_data)

```


```{r Think about species type allocations}
# Be clear on the allocation between species type and species. 

# Remove "aquatic animals nei" from dataset- not included in dietary guidelines
# Does this include invertebrates too and sharks etc.

# Main FAO species groups include: demersal, freshwater, pelagic, cephalopods, crustaceans,  molluscs an other.

# We have: Demersal, Pelagic, Mollusc, Crustacean, Cephalopod, OtherShellfish, 
# Freshwater, Shellfish, Unknown, OtherFishProducts, Marine fish and Invertebrates. 

# What species are in "other fish products"? should these be omitted from the data set? 


```



## Calculate edible portion of fish (grams) available per capita

```{r UK population by cohort}
# Adults are recommended to consume 2 portion of fish per week (not children) so calculate adult population size 

# Population size > 65. 
pop65_above <- read.csv("WB_pop_65.plus.csv")
str(pop65_above)

# Population size 15 to 64. 
pop15_64 <- read.csv("WB_pop_15.64.csv")
str(pop15_64)

# Population size 0 to 14.
# Children advised to consume half the dietary recommendation -> less than 15. 
pop0_14 <- read.csv("WB_pop_0.14.csv")
str(pop0_14)
```


```{r Average population size for each cohort between 2009 and 2019}
# Calculate average pop size over past 10 years for all age cohorts. New column with mean pop size
pop65_above$meanpop <- rowMeans(subset(pop65_above, select = c(X2007:X2017)), na.rm = TRUE)
pop15_64$meanpop <- rowMeans(subset(pop15_64, select = c(X2007:X2017)), na.rm = TRUE)
pop0_14$meanpop <- rowMeans(subset(pop0_14, select = c(X2007:X2017)), na.rm = TRUE)

# Combine all population cohorts
totalpop <- cbind.data.frame(pop65_above$?..Country.Name, pop65_above$meanpop, pop15_64$meanpop, pop0_14$meanpop)

# Rename dataframe columns 
names(totalpop)<-c("Country", "pop65", "pop15", "pop0")

# Create columns for adults and child pops
totalpop$adultpop<- totalpop$pop65+ totalpop$pop15
totalpop$childpop<- totalpop$pop0
totalpop$totpop<-totalpop$adultpop +(totalpop$childpop*0.5)

```



## Total UK population data (Office of National Statistics)

Download UK population data- need to convert per g/capita data to g/total UK total population.

```{r Load data}
# Read in UK population data 
df_NS_UK_pop_data <- vroom(file=paste(filepath,"NS_UK_population.csv", sep="/"))
```

```{r Subset data}
# Extract UK population data between 2009 onwards
df_UK_pop <- subset(df_NS_UK_pop_data, 
                      CDID > 2008, select= c(CDID, UKPOP))

```

```{r Add units and data source}
# Create "cleaned" data frame, defining units and data source 
df_clean_UK_pop <- df_UK_pop
df_clean_UK_pop$Units <- "UK-total-pop"
df_clean_UK_pop$Data_source <- "National-statistics"
```


```{r Calculate grams available per capita}

# Add in annual UK population data in a separate column. Duplicate population data for each year. Number of replicates dictated by number of rows in the short and narrow data set.
#df_UK_landings_200920$PopSize<- rep(c(df_clean_UK_pop$UKPOP), each = nrow(df_UK_landings_08_12_data))

# Convert grams/year to g/capita/year
#df_UK_landings_200920$ValueGramsCapitaYear<- #df_UK_landings_200920$ValueGrams/df_UK_landings_200920$PopSize

# Convert grams/year to g/capita/week
#df_UK_landings_200920$ValueGramsCapitaWeek<- df_UK_landings_200920$ValueGramsCapitaYear/52

```

```{r}
# Number of seafood entries differ per year so need to create a pipe
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2020"] <- 67081000
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2019"] <- 66796800
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2018"] <- 66435600
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2017"] <- 66040200
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2016"] <- 65648100
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2015"] <- 65110000
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2014"] <- 64596800
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2013"] <- 64105700
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2012"] <- 63705000
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2011"] <- 63285100
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2010"] <- 62759500
df_trade_HMRC_data$popSize[df_trade_HMRC_data$Year %in% "2009"] <- 62260500

# Make popsize column numerical value
df_trade_HMRC_data$popSize <- as.numeric(df_trade_HMRC_data$popSize)

# Calculate grams/capita/year
df_trade_HMRC_data$ValueGramsCapitaYear <- df_trade_HMRC_data$ValueGrams/df_trade_HMRC_data$popSize

# Calculate grams/capita/week
df_trade_HMRC_data$ValueGramsCapitaWeek <- df_trade_HMRC_data$ValueGramsCapitaYear/52

```



## Inital plots

## Figure 1. Annual UK seafood supply (g/capita/week) between 2009 and 2018

```{r Calculate annual UK seafood supply (g/capita/week) between 2009 and 2018}
# Sum amount of fish available g/capita/week per year for each commodity. 

# Name columns in aggregate function
captProd <- aggregate(list(CaptureProd = df_captProd_NS_data$ValueGramsCapitaWeek), 
                      list(Year = df_captProd_NS_data$Year), sum)
captProd <- subset(captProd, Year < 2019) # up to 2018

aquaProd <- aggregate(list(AquaProd = df_aquaProd_Eurostat_data_omit$ValueGramsCapitaWeek), 
                      list(Year = df_aquaProd_Eurostat_data_omit$Year), sum)
aquaProd <- subset(aquaProd, Year < 2019)# up to 2018

householdPurch <- aggregate(list(HPurch = df_housePurch_DEFRA_data$ValueGramsCapitaWeek), 
                      list(Year = df_housePurch_DEFRA_data$Year), sum)
householdPurch <- subset(householdPurch, Year < 2019) # up to 2018

eatenOutPurch <- aggregate(list(EOPurch = df_eatenOutPurch_DEFRA_data$ValueGramsCapitaWeek), 
                      list(Year = df_eatenOutPurch_DEFRA_data$Year), sum)
eatenOutPurch<- subset(eatenOutPurch, Year < 2019) # up to 2018


# Separate imports and export data
seafoodImports <- subset(df_trade_HMRC_data, Commodity == "Imports")
seafoodExports <- subset(df_trade_HMRC_data, Commodity == "Exports")

imports <- aggregate(list(Imports = seafoodImports$ValueGramsCapitaWeek), 
                      list(Year = seafoodImports$Year), sum)
imports <- subset(imports, Year < 2019) # up to 2018

exports <- aggregate(list(Exports = seafoodExports$ValueGramsCapitaWeek), 
                      list(Year = seafoodExports$Year), sum)
exports <- subset(exports, Year < 2019) # up to 2018

#captProd <- aggregate(df_captProd_NS_data$ValueGramsCapitaWeek, 
#                                       by = list(df_captProd_NS_data$Year), mean)
```


```{r Merge summed commodities bweteen 2009 and 2018 }
# Merge aggregated data
df_annualSeafood <- cbind(captProd, aquaProd[,2], imports[,2], exports[,2] )

# Rename column in the data frame
names(df_annualSeafood) <- c("Year", "CaptureProd", "Aquaprod", "Imports", "Exports")

```




```{r Calculate annual net seafood availabilty (grams/capita/week)}
# Calculate total seafood production
df_annualSeafood$totProd <- (df_annualSeafood$CaptureProd + df_annualSeafood$Aquaprod)

# Calculate average net seafood availability = (production + imports) - exports
df_annualSeafood$available <- (df_annualSeafood$totProd + 
                              df_annualSeafood$Imports) - df_annualSeafood$Exports 

```



```{r Plot annual UK seafood supply (g/capita/week) between 2009 and 2018}
# Plot annual seafood availability between 2009 and 2018
annual_seafood <- plot(available ~ Year, data = df_avgSeafood, pch= 20, type = "l", cex.axis = 1.0, cex.lab = 1.5, ylab = "Seafood available (g/capita/week)", xlab = "Year", ylim = c(0, 300))

# add in horizontal line marking dietary recommendation
abline(h = 280, col = "darkgreen")
```





## Figure 2. Average UK seafood supply (g/capita/week) between 2009 and 2018

```{r Plot average UK seafood supply (g/capita/week) between 2009 and 2018}

# Calculate mean seafood supplied into the UK between 2009 and 2018
# Transpose values and form a data frame 
avg_seafood <- as.data.frame(t(colMeans(df_annualSeafood)))


# Plot bar chart displaying imports (red bar), exports (grey bar), production (orange dot) and dietary recommendation (blue dot) as per Lofstedt et al 2021.

# Up to here...

# Read in NDNS fish consumption data and population cohort data from UK census
```



## Figure 3. UK fish production (capture and aqauculture)

```{r Plot annual UK seafood production (g/capita/week) between 2009 and 2018}
# Plot production (capture and aquaculture data separately)
plot(Aquaprod ~ Year, data = df_annualSeafood, cex.axis = 1.0, cex.lab = 1.5, ylab = "UK seafood production (g/capita/week)", xlab = "Year", ylim = c(0, 100))
lines(CaptureProd ~ Year, data = df_annualSeafood)

# Separate figures
plot(CaptureProd ~ Year, data = df_annualSeafood, cex.axis = 1.0, cex.lab = 1.5, ylab = "UK seafood production (g/capita/week)", xlab = "Year", ylim = c(0, 100))
lines(df_annualSeafood$CaptureProd)

plot(Aquaprod ~ Year, data = df_annualSeafood, cex.axis = 1.0, cex.lab = 1.5, ylab = "UK seafood production (g/capita/week)", xlab = "Year", ylim = c(0, 100), lines(df_annualSeafood$CaptureProd))

```



## Figure 4. Mapping SACN types (oily/lean/shellfish) per commodity

```{r Aggregate oily/lean/shellfish for each commodity}
# Capture Production 
SACN_captProd <- aggregate(df_captProd_NS_data$ValueGramsCapitaWeek, 
                                      by = list(df_captProd_NS_data$SACN,
                                                df_captProd_NS_data$Year), sum)
names(SACN_captProd) <- c("SACNType", "Year", "Summed_CProd")
SACN_captProd <- subset(SACN_captProd, Year < 2019) # up to 2018


# Aquaculture Production 
SACN_aquaProd <- aggregate(df_aquaProd_Eurostat_data_omit$ValueGramsCapitaWeek, 
                                      by = 
                             list(df_aquaProd_Eurostat_data_omit$SACN,
                                  df_aquaProd_Eurostat_data_omit$Year), sum)
names(SACN_aquaProd) <- c("SACNType", "Year", "Summed_AProd")
SACN_aquaProd <- subset(SACN_aquaProd, Year < 2019) # up to 2018


# Imports 
SACN_import <- aggregate(seafoodImports$ValueGramsCapitaWeek, 
                                      by = list(seafoodImports$SACN,
                                                seafoodImports$Year), sum)
names(SACN_import) <- c("SACNType", "Year", "Summed_import")
SACN_import <- subset(SACN_import, Year < 2019) # up to 2018


# Exports 
SACN_export <- aggregate(seafoodExports$ValueGramsCapitaWeek, 
                                      by = list(seafoodExports$SACN,
                                                seafoodExports$Year), sum)
names(SACN_export) <- c("SACNType", "Year", "Summed_export")
SACN_export <- subset(SACN_export, Year < 2019) # up to 2018

```


```{r Merge SACN commodity data bweteen 2009 and 2018 }
# Merge aggregated data
# List all data frames to join together 
SACN_dfs <- list(SACN_captProd, SACN_aquaProd, SACN_import, SACN_export)


# Join data frames by SCANType and Year
df_summedSACNTypes <- join_all(SACN_dfs, by = c("SACNType", "Year")) 

```


## Figure 5. Identify the top 5 produced (capture fisheries) seafood species in the UK

```{r Idenitfying the most produced (capture fisheries) seafood species in the UK each year}
capture09 <- subset(df_captProd_NS_data, Year == 2009)
arrange(capture09, desc(ValueGramsCapitaWeek)) # mackerel, haddock, herring, nephrops, scallops

capture10 <- subset(df_captProd_NS_data, Year == 2010)
arrange(capture10, desc(ValueGramsCapitaWeek)) # mackerel, haddock, herring, nephrops, scallops

capture11 <- subset(df_captProd_NS_data, Year == 2011)
arrange(capture11, desc(ValueGramsCapitaWeek)) # mackerel, haddock, herring, nephrops, scallops

capture12 <- subset(df_captProd_NS_data, Year == 2012)
arrange(capture12, desc(ValueGramsCapitaWeek)) # mackerel, haddock, herring, nephrops, scallops

capture13 <- subset(df_captProd_NS_data, Year == 2013)
arrange(capture13, desc(ValueGramsCapitaWeek)) # mackerel, haddock, herring, scallops, crabs

capture14 <- subset(df_captProd_NS_data, Year == 2014)
arrange(capture14, desc(ValueGramsCapitaWeek)) # mackerel, haddock, herring, scallops, crabs 

capture15 <- subset(df_captProd_NS_data, Year == 2015)
arrange(capture15, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock scallops, crabs 

capture16 <- subset(df_captProd_NS_data, Year == 2016)
arrange(capture16, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock scallops, cod 

capture17 <- subset(df_captProd_NS_data, Year == 2017)
arrange(capture17, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock scallops, cod 

capture18 <- subset(df_captProd_NS_data, Year == 2018)
arrange(capture18, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock, cod, blue whiting 

capture19 <- subset(df_captProd_NS_data, Year == 2019)
arrange(capture19, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock, cod, nephrops whiting 

capture20 <- subset(df_captProd_NS_data, Year == 2020)
arrange(capture18, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock, cod, blue whiting 


# Subset the most caught seafood species as identified from above
top5Capture <- subset(df_captProd_NS_data, Species == "Mackerel" | Species == "Herring" | Species == "Haddock")

# Plot capture production between 2009 and 2020
plot(ValueGramsCapitaWeek ~ Year, data= top5Capture, pch= 20, col= c("blue", "green", "red"), cex.axis = 1.0, cex.lab = 1.5, ylab = "Seafood produced (g/capita/week)", xlab = "Year", ylim = c(0, 25))

```



## Figure 6. Identify the top 5 produced (capture and aquculture fisheries) seafood species in the UK


```{r Idenitfying the most produced (capture and aquaculture fisheries) seafood species in the UK each year}

# Combine capture and aquaculture data sets to get total UK seafood production
UK_production <- rbind(df_captProd_NS_data, df_aquaProd_Eurostat_data_omit)

capture09 <- subset(UK_production, Year == 2009)
arrange(capture09, desc(ValueGramsCapitaWeek)) # salmon, mackerel, haddock, herring, nephrops

capture10 <- subset(UK_production, Year == 2010)
arrange(capture10, desc(ValueGramsCapitaWeek)) # salmon, mackerel, herring, haddock, scallops

capture11 <- subset(UK_production, Year == 2011)
arrange(capture11, desc(ValueGramsCapitaWeek)) # salmon, mackerel, herring, scallop, haddock

capture12 <- subset(UK_production, Year == 2012)
arrange(capture12, desc(ValueGramsCapitaWeek)) # mackerel, haddock, herring, nephrops, scallops

capture13 <- subset(UK_production, Year == 2013)
arrange(capture13, desc(ValueGramsCapitaWeek)) # salmon, mackerel, herring, scallops, crabs # change

capture14 <- subset(UK_production, Year == 2014)
arrange(capture14, desc(ValueGramsCapitaWeek)) # mackerel, haddock, herring, scallops, crabs 

capture15 <- subset(UK_production, Year == 2015)
arrange(capture15, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock scallops, crabs 

capture16 <- subset(UK_production, Year == 2016)
arrange(capture16, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock scallops, cod # change

capture17 <- subset(UK_production, Year == 2017)
arrange(capture17, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock scallops, cod 

capture18 <- subset(UK_production, Year == 2018)
arrange(capture18, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock, cod, blue whiting 

capture19 <- subset(UK_production, Year == 2019) # no aqaucaulture data
arrange(capture19, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock, cod, nephrops whiting 

capture20 <- subset(UK_production, Year == 2020)
arrange(capture18, desc(ValueGramsCapitaWeek)) # mackerel, herring, haddock, cod, blue whiting 


# Subset the most caught seafood species as identified from above
top5TotProduction <- subset(UK_production, Species == "Salmon" | Species == "Mackerel" | Species == "Herring" | Species == "Haddock")

# Plot capture production between 2009 and 2020
plot(ValueGramsCapitaWeek ~ Year, data= top5TotProduction, pch= 20, col= c("blue", "green", "red", "orange"), cex.axis = 1.0, cex.lab = 1.5, ylab = "Seafood produced (g/capita/week)", xlab = "Year", ylim = c(0, 20)) # Much overlap thus hard to see the colors

```


## Figure 7. Mapping nutrient availability 

Here we map the nutrient content of the 5 most produced fish species in the UK between 2009 and 2018. The nutrients mapped included omega-3, calcium, iron, selenium, and zinc. Estimated nutrient data was obtained from PHE. 

```{r Mapping the availabilty of individual nutrients}
# The nutrient content of salmon, mackerel, herring and haddock was mapped between 2009 and 2018.
```


## Figure 8. Seafood availabilty by species and species type

```{r Seafood availabilty by species and species type}

# Separate imports and export data
seafoodImports <- subset(df_trade_HMRC_data, Commodity == "Imports")
seafoodExports <- subset(df_trade_HMRC_data, Commodity == "Exports")

# Merge aggregated data by species name and year
# List all data frames to join together 
seafood_dfs <- list(df_captProd_NS_data, df_aquaProd_Eurostat_data_omit, seafoodImports, seafoodExports)

# Join data frames by species and year
df_UKseafood_200918 <- join_all(seafood_dfs, by = c("SpeciesNEW", "Year")) 
str(df_summedSACNTypes)


## Up to here. Need to seclect specific column and make dataframe long and thin to succesfully aggregate apecies. 


# Select desired columns from data frame
wanted_seafoodCols <- df_summedSACNTypes[,c(1,2,3,4,5,6,9,14,15,22,25,30,33)]

# Rename columns in data frame
colnames(wanted_seafoodCols) <- c("...1", "SACN","SpeciesType", "SpeciesNEW", "Year", "ValueCapture","CommodityCapture", "ValueAqua","CommodityAqua", "ValueImport","CommodityImport", "ValueExport","CommodityExport")

# Make data frame long and narrow

# Calculate availability for each species
wanted_seafoodCols$available <- (wanted_seafoodCols$ValueCapture + wanted_seafoodCols$ValueAqua + wanted_seafoodCols$ValueImport) - wanted_seafoodCols$ValueExport

str(wanted_seafoodCols)

# Aggregate data by species
seafood_avg <- aggregate(wanted_seafoodCols$available, by = "SpeciesNEW", FUN = mean)

seafood_avg_by_species <- aggregate(wanted_seafoodCols$available, by = 
                      list(wanted_seafoodCols$SpeciesNEW, wanted_seafoodCols$Year),
                      mean)

boxplot(wanted_seafoodCols)

SACN_captProd <- aggregate(df_captProd_NS_data$ValueGramsCapitaWeek, 
                                      by = list(df_captProd_NS_data$SACN,
                                                df_captProd_NS_data$Year), sum)


```


